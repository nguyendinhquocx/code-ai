# Phase -1: Pre-requisites Discovery Framework

**Má»¥c Ä‘Ã­ch**: Chuáº©n bá»‹ Ä‘áº§y Ä‘á»§ resources (API keys, database, configs) TRÆ¯á»šC KHI báº¯t Ä‘áº§u implement

**Triáº¿t lÃ½**: "Mise en place" - Chuáº©n bá»‹ nguyÃªn liá»‡u trÆ°á»›c khi náº¥u

---

## ğŸ¯ Táº¡i sao cáº§n Phase -1?

### Váº¥n Ä‘á» thÆ°á»ng gáº·p:
```
User: "LÃ m app chat vá»›i Supabase"
AI: [Code ngay] â†’ Generate schema, API, UI
User: "ÃŠ mÃ  tao chÆ°a cÃ³ Supabase, API key láº¥y Ä‘Ã¢u?"
â†’ PHÃ Sáº¢N workflow, lÃ m láº¡i tá»« Ä‘áº§u âŒ
```

### Vá»›i Phase -1:
```
User: "LÃ m app chat vá»›i Supabase"
AI: [Dá»ªNG] "Cáº§n Supabase URL vÃ  keys. MÃ y cÃ³ chÆ°a?"
User: "ChÆ°a"
AI: [Guide setup] â†’ User lÃ m xong â†’ Store configs
AI: [Tiáº¿n hÃ nh Phase 0-8] â†’ Smooth workflow âœ…
```

---

## ğŸ“‹ Workflow Overview

```
USER REQUEST
    â†“
Phase -1: Pre-requisites Discovery â­
â”œâ”€ Analyze requirements
â”œâ”€ Detect needed resources
â”œâ”€ Interactive checklist
â”œâ”€ Guide setup (if needed)
â”œâ”€ Validate & store
â””â”€ Confirm ready âœ…
    â†“
Phase 0: Setup & Understanding
    â†“
Phase 1-N: Execute workflow
    â†“
DONE
```

---

## ğŸ”§ Components

### 1. **Templates** (`templates/`)
- `prerequisites-template.yaml` - Resource checklist structure
- `env-template.txt` - .env file template
- `config-template.yaml` - Config file template

### 2. **Guides** (`guides/`)
- Service-specific setup guides (Supabase, OpenAI, Stripe, etc.)
- Step-by-step vá»›i screenshots
- Troubleshooting common issues

### 3. **Examples** (`examples/`)
- Real-world examples cho different project types
- Supabase app, API integration, ML project, etc.

---

## ğŸš€ Quick Start

### Trigger Phase -1

**Auto-detect** (tá»« keywords):
```
User: "LÃ m app vá»›i Supabase vÃ  OpenAI"
â†’ AI tá»± Ä‘á»™ng detect: cáº§n Supabase + OpenAI resources
â†’ Start Phase -1
```

**Explicit command**:
```
/prereq check       # Check requirements cho project
/prereq setup       # Interactive setup
/prereq validate    # Validate existing resources
/prereq guide       # Show available guides
```

### Interactive Flow

```markdown
ğŸ“‹ Pre-requisites Checklist: Supabase Chat App

## âœ… REQUIRED Resources

### Supabase
- [ ] Project URL (SUPABASE_URL)
- [ ] Anon Key (SUPABASE_ANON_KEY)
- [ ] Database table: messages

**ChÆ°a cÃ³?** â†’ GÃµ "guide supabase"

## ğŸ”‘ OPTIONAL Resources

### OpenAI (for AI features)
- [ ] API Key (OPENAI_API_KEY)

---

GÃµ:
- "ready" - ÄÃ£ cÃ³ táº¥t cáº£
- "guide <service>" - HÆ°á»›ng dáº«n setup
- "skip <item>" - Skip optional
```

---

## ğŸ“ Storage Format

**Combo: .env + YAML**

### `.env.local` (Secrets)
```bash
# Generated by Phase -1
# DO NOT COMMIT

SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_ANON_KEY=eyJxxx...
OPENAI_API_KEY=sk-xxx...
```

### `config/prerequisites.yaml` (Non-sensitive)
```yaml
project: "Supabase Chat App"
phase: "completed"  # pending | in_progress | completed

services:
  supabase:
    status: "ready"
    resources:
      - key: SUPABASE_URL
        value_from: .env.local
        validated: true
        validated_at: "2025-11-27T20:30:00Z"

      - key: SUPABASE_ANON_KEY
        value_from: .env.local
        validated: true

  openai:
    status: "skipped"
    optional: true

database:
  tables:
    - name: "messages"
      status: "created"
      created_at: "2025-11-27T20:32:00Z"
```

---

## ğŸ“ Guided Setup

### Level: Detailed (Máº·c Ä‘á»‹nh)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ HÆ¯á»šNG DáºªN SETUP SUPABASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Thá»i gian: ~5 phÃºt
Chi phÃ­: FREE

BÆ¯á»šC 1: Táº¡o Account
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. VÃ o https://supabase.com
2. Click "Start your project"
3. Sign up vá»›i GitHub
4. XÃ¡c nháº­n email

BÆ¯á»šC 2: Táº¡o Project
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Click "New Project"
2. Name: "chat-app"
3. Password: [Táº¡o & lÆ°u láº¡i]
4. Region: "Southeast Asia (Singapore)"
5. Click "Create" â†’ Äá»£i 2 phÃºt

BÆ¯á»šC 3: Láº¥y Keys
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Settings â†’ API
2. Copy:
   - Project URL
   - anon public key

BÆ¯á»šC 4: Paste cho tao
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SUPABASE_URL=...
SUPABASE_ANON_KEY=...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## âœ… Validation

### Level: Connection Test (Máº·c Ä‘á»‹nh)

```python
def validate_supabase(url, key):
    # Format check
    if not url.startswith("https://") or not ".supabase.co" in url:
        return "âŒ Invalid URL format"

    # Connection test
    response = requests.get(f"{url}/rest/v1/", headers={
        "apikey": key,
        "Authorization": f"Bearer {key}"
    })

    if response.status_code == 200:
        return "âœ… Connection successful"
    else:
        return f"âš ï¸ Connection failed: {response.status_code}"
```

---

## ğŸ”„ Resume Capability

Náº¿u user thoÃ¡t giá»¯a chá»«ng:

```
Session 1:
User: "LÃ m Supabase app"
AI: "Cáº§n keys..." â†’ User thoÃ¡t

Session 2:
User: "Tiáº¿p tá»¥c"
AI: Load config/prerequisites.yaml
    â†’ "Tao tháº¥y project chÆ°a xong. Resume Phase -1?"
    â†’ Show checklist vá»›i items Ä‘Ã£ done âœ…
    â†’ Continue tá»« chá»— dá»«ng
```

---

## ğŸ¯ Integration

### VÃ o Data Analyst Workflow
```yaml
# workflow-analytics-tong-quan.md

Phase -1: Pre-requisites (NEW)
â””â”€ Check data file accessible
â””â”€ Check Python dependencies
â””â”€ Check output directories writable

Phase 0: Setup & Understanding
...
```

### VÃ o Speckit Workflow
```yaml
# speckit.specify.md

Phase -1: Pre-requisites (NEW)
â””â”€ Detect services from feature description
â””â”€ Check API keys, database configs
â””â”€ Guide setup if needed

Phase 0: Generate Spec
...
```

---

## ğŸ“ Configuration

### Auto-detection Rules

```yaml
# prerequisites/detection-rules.yaml

patterns:
  supabase:
    keywords: ["supabase", "realtime database", "postgres"]
    resources:
      - SUPABASE_URL
      - SUPABASE_ANON_KEY
    guide: "guides/supabase-setup.md"

  openai:
    keywords: ["openai", "gpt", "chatgpt", "ai chat"]
    resources:
      - OPENAI_API_KEY
    guide: "guides/openai-setup.md"

  stripe:
    keywords: ["stripe", "payment", "checkout"]
    resources:
      - STRIPE_PUBLIC_KEY
      - STRIPE_SECRET_KEY
    guide: "guides/stripe-setup.md"
```

---

## ğŸ› ï¸ Smart Behaviors

### Auto-setup (Khi cÃ³ thá»ƒ)
```
Supabase table cáº§n táº¡o:
â†’ AI: "Tao cÃ³ thá»ƒ táº¡o table tá»± Ä‘á»™ng. OK khÃ´ng? [Y/n]"
â†’ User: "Y"
â†’ AI: Run SQL script â†’ Create table âœ…
```

### Missing Optional Resources
```
OpenAI key thiáº¿u:
â†’ AI: "No OpenAI key. Alternatives:
      (1) Skip AI features
      (2) Use local model (slower)
      (3) Setup OpenAI now

      Chá»n: [1/2/3]"
```

### Multi-service Prioritized
```
Project cáº§n: Supabase (required) + OpenAI (optional) + Stripe (optional)

AI: "REQUIRED: Supabase (setup trÆ°á»›c)"
    â†’ Guide Supabase â†’ Done âœ…

    "OPTIONAL: OpenAI, Stripe"
    "MÃ y muá»‘n setup luÃ´n hay skip? [setup/skip]"
```

---

## ğŸ“š Available Guides

- `guides/supabase-setup.md` - Supabase tá»« A-Z
- `guides/openai-setup.md` - OpenAI API keys
- `guides/stripe-setup.md` - Stripe payment
- `guides/firebase-setup.md` - Firebase
- `guides/postgres-local.md` - Local PostgreSQL
- `guides/mongodb-setup.md` - MongoDB Atlas

---

## ğŸ¯ Success Criteria

Phase -1 hoÃ n thÃ nh khi:

- âœ… Táº¥t cáº£ REQUIRED resources cÃ³ sáºµn
- âœ… Validated (format + connection test)
- âœ… Stored in `.env.local` + `config/prerequisites.yaml`
- âœ… Optional resources: decided (cÃ³/skip/alternative)
- âœ… User confirm "ready to proceed"

â†’ Proceed to Phase 0 âœ…

---

**Version**: 1.0.0
**Created**: 2025-11-27
**Integration**: Data Analyst Workflow, Speckit Workflow
